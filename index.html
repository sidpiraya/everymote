<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Everymote</title>
    <link rel="stylesheet" href="sp://import/css/adam.css">
    <link rel="stylesheet" href="sp://import/css/api.css">
    <style>
           
            @import url('sp://import/css/list.css');
            @import url('sp://import/css/player.css');
            @import url('sp://import/css/ui.css');
            h1, ul {margin:0 0 30px;}
            a:hover {color:#83be20;}
        </style>
    <script src="http://thing.everymote.com/socket.io/socket.io.js"></script>
    <script src="sp://everymote/js/jquery-1.7.min.js"></script>

    <script>



            $(document).ready(function() {
                sp = getSpotifyApi(1);
                console.log(sp);
                var models = sp.require('sp://import/scripts/api/models');
                var everymote = sp.require('everymote');
                var views = sp.require("sp://import/scripts/api/views");
                var tempPlaylist = new models.Playlist();

                var tabs = function() {
                    var args = models.application.arguments;
                    console.log(args[0]);
                    $('.section').hide();
                    $('#'+args[0]).show();
                };
               
 
                tabs();
                models.application.observe(models.EVENT.ARGUMENTSCHANGED, tabs);

                everymote.init(models, tempPlaylist);

               
                var tracks = models.library.tracks;
               // var track = tracks[Math.floor(Math.random()*tracks.length)]
                //clearPlaylist(tempPlaylist);
                //tempPlaylist.add(track.data.uri);
                //player.play(track.data.uri, tempPlaylist.data.uri, 0);
                //e.preventDefault();

                //var tracks = models.library.starredPlaylist;

                console.log(models.session.anonymousUserID);
                /* Create a temporary playlist and fill it with tracks
                 * from the previous query */
                
                for(var i=0;i<10;i++) {
                    
                    tempPlaylist.add(tracks[Math.floor(Math.random()*tracks.length)]);
                }


                models.player.play(tempPlaylist.get(0), tempPlaylist, 0);



                var playlist = new views.List(tempPlaylist);
            
                $('#player').append(playlist.node);

                $("#name").focusout( function() {
                    localStorage.setItem('name', $(this).val());
                    everymote.updateName();
                });

                $("#name").val(localStorage.getItem("name"));
            });
        </script>
</head>
<body>
    <div id="index" class="section">
        <h1 id="header">Hello, world!</h1>
        <div id="player"></div>
    </div>
    <div id="settings" class="section">
        <h1>Settings</h1>
        <label>Name:</label> <input type="text" id="name"></input>
    </div>
</body>
</html>
